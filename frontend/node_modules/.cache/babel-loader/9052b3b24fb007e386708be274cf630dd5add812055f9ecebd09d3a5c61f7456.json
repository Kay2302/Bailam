{"ast":null,"code":"// Trong hàm login của AuthContext.js\nconst login = async (email, password) => {\n  try {\n    setError(null);\n    setLoading(true);\n    const response = await userApi.login({\n      email,\n      password\n    });\n    if (!response.data) {\n      throw new Error('Không nhận được phản hồi từ server');\n    }\n    const {\n      token,\n      user\n    } = response.data;\n    if (!token || !user) {\n      throw new Error('Dữ liệu đăng nhập không hợp lệ');\n    }\n\n    // Lưu thông tin xác thực\n    localStorage.setItem('token', token);\n    localStorage.setItem('userId', user.id);\n    localStorage.setItem('userRole', user.role || 'customer');\n    localStorage.setItem('isAuthenticated', 'true'); // Thêm dòng này\n\n    setCurrentUser(user);\n    setIsAuthenticated(true);\n    setUserRole(user.role || 'customer');\n    return user;\n  } catch (err) {\n    var _err$response, _err$response$data;\n    console.error('Lỗi đăng nhập:', err);\n    setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || 'Đăng nhập thất bại. Vui lòng thử lại.');\n    throw err;\n  } finally {\n    setLoading(false);\n  }\n};\n\n// Tương tự, cập nhật trong hàm logout\nconst logout = () => {\n  // Xóa thông tin xác thực\n  localStorage.removeItem('token');\n  localStorage.removeItem('userId');\n  localStorage.removeItem('userRole');\n  localStorage.removeItem('isAuthenticated'); // Thêm dòng này\n\n  setCurrentUser(null);\n  setIsAuthenticated(false);\n  setUserRole('');\n};","map":{"version":3,"names":["login","email","password","setError","setLoading","response","userApi","data","Error","token","user","localStorage","setItem","id","role","setCurrentUser","setIsAuthenticated","setUserRole","err","_err$response","_err$response$data","console","error","message","logout","removeItem"],"sources":["D:/UDW/BaiLam/frontend/src/contexts/AuthContext.js"],"sourcesContent":["// Trong hàm login của AuthContext.js\r\nconst login = async (email, password) => {\r\n  try {\r\n    setError(null);\r\n    setLoading(true);\r\n    \r\n    const response = await userApi.login({ email, password });\r\n    \r\n    if (!response.data) {\r\n      throw new Error('Không nhận được phản hồi từ server');\r\n    }\r\n    \r\n    const { token, user } = response.data;\r\n    \r\n    if (!token || !user) {\r\n      throw new Error('Dữ liệu đăng nhập không hợp lệ');\r\n    }\r\n    \r\n    // Lưu thông tin xác thực\r\n    localStorage.setItem('token', token);\r\n    localStorage.setItem('userId', user.id);\r\n    localStorage.setItem('userRole', user.role || 'customer');\r\n    localStorage.setItem('isAuthenticated', 'true'); // Thêm dòng này\r\n    \r\n    setCurrentUser(user);\r\n    setIsAuthenticated(true);\r\n    setUserRole(user.role || 'customer');\r\n    \r\n    return user;\r\n  } catch (err) {\r\n    console.error('Lỗi đăng nhập:', err);\r\n    setError(err.response?.data?.message || 'Đăng nhập thất bại. Vui lòng thử lại.');\r\n    throw err;\r\n  } finally {\r\n    setLoading(false);\r\n  }\r\n};\r\n\r\n// Tương tự, cập nhật trong hàm logout\r\nconst logout = () => {\r\n  // Xóa thông tin xác thực\r\n  localStorage.removeItem('token');\r\n  localStorage.removeItem('userId');\r\n  localStorage.removeItem('userRole');\r\n  localStorage.removeItem('isAuthenticated'); // Thêm dòng này\r\n  \r\n  setCurrentUser(null);\r\n  setIsAuthenticated(false);\r\n  setUserRole('');\r\n};"],"mappings":"AAAA;AACA,MAAMA,KAAK,GAAG,MAAAA,CAAOC,KAAK,EAAEC,QAAQ,KAAK;EACvC,IAAI;IACFC,QAAQ,CAAC,IAAI,CAAC;IACdC,UAAU,CAAC,IAAI,CAAC;IAEhB,MAAMC,QAAQ,GAAG,MAAMC,OAAO,CAACN,KAAK,CAAC;MAAEC,KAAK;MAAEC;IAAS,CAAC,CAAC;IAEzD,IAAI,CAACG,QAAQ,CAACE,IAAI,EAAE;MAClB,MAAM,IAAIC,KAAK,CAAC,oCAAoC,CAAC;IACvD;IAEA,MAAM;MAAEC,KAAK;MAAEC;IAAK,CAAC,GAAGL,QAAQ,CAACE,IAAI;IAErC,IAAI,CAACE,KAAK,IAAI,CAACC,IAAI,EAAE;MACnB,MAAM,IAAIF,KAAK,CAAC,gCAAgC,CAAC;IACnD;;IAEA;IACAG,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEH,KAAK,CAAC;IACpCE,YAAY,CAACC,OAAO,CAAC,QAAQ,EAAEF,IAAI,CAACG,EAAE,CAAC;IACvCF,YAAY,CAACC,OAAO,CAAC,UAAU,EAAEF,IAAI,CAACI,IAAI,IAAI,UAAU,CAAC;IACzDH,YAAY,CAACC,OAAO,CAAC,iBAAiB,EAAE,MAAM,CAAC,CAAC,CAAC;;IAEjDG,cAAc,CAACL,IAAI,CAAC;IACpBM,kBAAkB,CAAC,IAAI,CAAC;IACxBC,WAAW,CAACP,IAAI,CAACI,IAAI,IAAI,UAAU,CAAC;IAEpC,OAAOJ,IAAI;EACb,CAAC,CAAC,OAAOQ,GAAG,EAAE;IAAA,IAAAC,aAAA,EAAAC,kBAAA;IACZC,OAAO,CAACC,KAAK,CAAC,gBAAgB,EAAEJ,GAAG,CAAC;IACpCf,QAAQ,CAAC,EAAAgB,aAAA,GAAAD,GAAG,CAACb,QAAQ,cAAAc,aAAA,wBAAAC,kBAAA,GAAZD,aAAA,CAAcZ,IAAI,cAAAa,kBAAA,uBAAlBA,kBAAA,CAAoBG,OAAO,KAAI,uCAAuC,CAAC;IAChF,MAAML,GAAG;EACX,CAAC,SAAS;IACRd,UAAU,CAAC,KAAK,CAAC;EACnB;AACF,CAAC;;AAED;AACA,MAAMoB,MAAM,GAAGA,CAAA,KAAM;EACnB;EACAb,YAAY,CAACc,UAAU,CAAC,OAAO,CAAC;EAChCd,YAAY,CAACc,UAAU,CAAC,QAAQ,CAAC;EACjCd,YAAY,CAACc,UAAU,CAAC,UAAU,CAAC;EACnCd,YAAY,CAACc,UAAU,CAAC,iBAAiB,CAAC,CAAC,CAAC;;EAE5CV,cAAc,CAAC,IAAI,CAAC;EACpBC,kBAAkB,CAAC,KAAK,CAAC;EACzBC,WAAW,CAAC,EAAE,CAAC;AACjB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}