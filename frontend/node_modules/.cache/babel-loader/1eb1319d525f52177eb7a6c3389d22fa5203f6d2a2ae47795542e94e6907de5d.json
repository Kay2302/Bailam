{"ast":null,"code":"var _jsxFileName = \"D:\\\\UDW\\\\BaiLam\\\\frontend\\\\src\\\\components\\\\Cart.js\",\n  _s = $RefreshSig$();\n// src/components/Cart.js\nimport React, { useState, useEffect } from 'react';\nimport { Container, Table, Button, Card, Row, Col, Alert, Form, InputGroup } from 'react-bootstrap';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { FaTrash, FaMinus, FaPlus, FaArrowLeft, FaShoppingCart, FaCreditCard, FaTag } from 'react-icons/fa';\nimport Nav from './Nav';\nimport Footer from './Footer';\nimport { useProduct } from '../contexts/ProductContext';\nimport { useAuth } from '../contexts/AuthContext';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction Cart() {\n  _s();\n  const navigate = useNavigate();\n  const {\n    cart,\n    updateCartItem,\n    removeFromCart,\n    clearCart,\n    getCartTotal\n  } = useProduct();\n  const {\n    isAuthenticated\n  } = useAuth();\n  const [total, setTotal] = useState(0);\n  const [subTotal, setSubTotal] = useState(0);\n  const [couponCode, setCouponCode] = useState('');\n  const [discount, setDiscount] = useState(0);\n  const [couponApplied, setCouponApplied] = useState(false);\n  const [couponError, setCouponError] = useState('');\n  const [shippingMethod, setShippingMethod] = useState('standard');\n  const [shippingCost, setShippingCost] = useState(5.99);\n  const [loading, setLoading] = useState(false);\n\n  // Tính toán tổng tiền khi giỏ hàng thay đổi\n  useEffect(() => {\n    const itemsTotal = getCartTotal();\n    setSubTotal(itemsTotal);\n    setTotal(itemsTotal + shippingCost - discount);\n  }, [cart, discount, shippingCost, getCartTotal]);\n\n  // Cập nhật số lượng sản phẩm\n  const handleUpdateQuantity = async (id, newQuantity) => {\n    if (newQuantity < 1) return;\n    setLoading(true);\n\n    // Tìm sản phẩm để kiểm tra kho hàng\n    const item = cart.find(item => item.id === id);\n    if (item && newQuantity > item.stock) {\n      alert(`Chỉ còn ${item.stock} sản phẩm trong kho!`);\n      setLoading(false);\n      return;\n    }\n    try {\n      await updateCartItem(id, newQuantity);\n    } catch (error) {\n      console.error('Lỗi khi cập nhật số lượng:', error);\n      alert('Không thể cập nhật số lượng sản phẩm. Vui lòng thử lại sau.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Xóa sản phẩm khỏi giỏ hàng\n  const handleRemoveItem = async id => {\n    if (window.confirm('Bạn có chắc muốn xóa sản phẩm này khỏi giỏ hàng?')) {\n      setLoading(true);\n      try {\n        await removeFromCart(id);\n      } catch (error) {\n        console.error('Lỗi khi xóa sản phẩm:', error);\n        alert('Không thể xóa sản phẩm. Vui lòng thử lại sau.');\n      } finally {\n        setLoading(false);\n      }\n    }\n  };\n\n  // Áp dụng mã giảm giá\n  const applyCoupon = async () => {\n    if (!couponCode) {\n      setCouponError('Vui lòng nhập mã giảm giá');\n      return;\n    }\n    setLoading(true);\n    setCouponError('');\n    try {\n      // Gọi API để kiểm tra và áp dụng mã giảm giá\n      const response = await fetch(`http://localhost:5000/api/coupons/check`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        },\n        body: JSON.stringify({\n          code: couponCode\n        })\n      });\n      const data = await response.json();\n      if (response.ok && data.valid) {\n        const discountAmount = subTotal * (data.discount / 100);\n        setDiscount(discountAmount);\n        setCouponApplied(true);\n      } else {\n        // Nếu không có API hoặc API không trả về kết quả hợp lệ, sử dụng mã giảm giá mẫu\n        if (couponCode === 'SALE10') {\n          const discountAmount = subTotal * 0.1;\n          setDiscount(discountAmount);\n          setCouponApplied(true);\n        } else if (couponCode === 'SALE20') {\n          const discountAmount = subTotal * 0.2;\n          setDiscount(discountAmount);\n          setCouponApplied(true);\n        } else if (couponCode === 'FREESHIP') {\n          setShippingCost(0);\n          setCouponApplied(true);\n        } else {\n          setCouponError('Mã giảm giá không hợp lệ hoặc đã hết hạn');\n        }\n      }\n    } catch (error) {\n      console.error('Lỗi khi áp dụng mã giảm giá:', error);\n      setCouponError('Không thể áp dụng mã giảm giá. Vui lòng thử lại.');\n\n      // Fallback sử dụng mã giảm giá mẫu nếu không kết nối được API\n      if (couponCode === 'SALE10') {\n        const discountAmount = subTotal * 0.1;\n        setDiscount(discountAmount);\n        setCouponApplied(true);\n      } else if (couponCode === 'SALE20') {\n        const discountAmount = subTotal * 0.2;\n        setDiscount(discountAmount);\n        setCouponApplied(true);\n      } else if (couponCode === 'FREESHIP') {\n        setShippingCost(0);\n        setCouponApplied(true);\n      } else {\n        setCouponError('Mã giảm giá không hợp lệ hoặc đã hết hạn');\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Xử lý thay đổi phương thức vận chuyển\n  const handleShippingChange = e => {\n    const method = e.target.value;\n    setShippingMethod(method);\n    switch (method) {\n      case 'express':\n        setShippingCost(12.99);\n        break;\n      case 'overnight':\n        setShippingCost(19.99);\n        break;\n      case 'standard':\n      default:\n        setShippingCost(5.99);\n    }\n  };\n\n  // Thay đổi phần xử lý checkout để đồng bộ với API\n\n  const handleCheckout = () => {\n    if (cart.length === 0) {\n      alert('Giỏ hàng của bạn đang trống!');\n      return;\n    }\n    if (!isAuthenticated) {\n      // Lưu thông tin đơn hàng vào sessionStorage để khôi phục sau khi đăng nhập\n      sessionStorage.setItem('pendingCheckout', JSON.stringify({\n        items: cart,\n        subTotal,\n        discount,\n        shippingCost,\n        total,\n        shippingMethod\n      }));\n      if (window.confirm('Bạn cần đăng nhập để tiếp tục thanh toán. Chuyển đến trang đăng nhập?')) {\n        navigate('/login', {\n          state: {\n            returnUrl: '/checkout'\n          }\n        });\n      }\n      return;\n    }\n    try {\n      // Chuẩn bị thông tin đơn hàng\n      const orderSummary = {\n        items: cart.map(item => ({\n          id: item.id,\n          product_id: item.id,\n          name: item.name,\n          price: item.price,\n          discountPrice: item.discountPrice || item.discount_price,\n          quantity: item.quantity,\n          image: item.image,\n          stock: item.stock\n        })),\n        subTotal,\n        discount,\n        shippingCost,\n        total,\n        shippingMethod\n      };\n\n      // Lưu vào sessionStorage để sử dụng ở trang Checkout\n      sessionStorage.setItem('orderSummary', JSON.stringify(orderSummary));\n\n      // Chuyển đến trang thanh toán\n      navigate('/checkout');\n    } catch (error) {\n      console.error('Error during checkout preparation:', error);\n      alert('Có lỗi xảy ra khi chuẩn bị thanh toán. Vui lòng thử lại.');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Nav, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Container, {\n      className: \"py-5 mt-5\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(FaShoppingCart, {\n          className: \"me-2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 11\n        }, this), \"Gi\\u1ECF h\\xE0ng c\\u1EE7a b\\u1EA1n\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 9\n      }, this), cart.length === 0 ? /*#__PURE__*/_jsxDEV(Row, {\n        children: /*#__PURE__*/_jsxDEV(Col, {\n          children: /*#__PURE__*/_jsxDEV(Alert, {\n            variant: \"info\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center py-4\",\n              children: [/*#__PURE__*/_jsxDEV(FaShoppingCart, {\n                size: 50,\n                className: \"mb-3 text-muted\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 228,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"Gi\\u1ECF h\\xE0ng c\\u1EE7a b\\u1EA1n \\u0111ang tr\\u1ED1ng\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 229,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"mb-4\",\n                children: \"H\\xE3y th\\xEAm s\\u1EA3n ph\\u1EA9m v\\xE0o gi\\u1ECF h\\xE0ng \\u0111\\u1EC3 ti\\u1EBFp t\\u1EE5c mua s\\u1EAFm.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 230,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Link, {\n                to: \"/products\",\n                className: \"btn btn-primary\",\n                children: [/*#__PURE__*/_jsxDEV(FaArrowLeft, {\n                  className: \"me-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 232,\n                  columnNumber: 21\n                }, this), \" Ti\\u1EBFp t\\u1EE5c mua s\\u1EAFm\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 231,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 227,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(Row, {\n        children: [/*#__PURE__*/_jsxDEV(Col, {\n          lg: 8,\n          children: [/*#__PURE__*/_jsxDEV(Card, {\n            className: \"mb-4 shadow-sm\",\n            children: /*#__PURE__*/_jsxDEV(Card.Body, {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"table-responsive\",\n                children: /*#__PURE__*/_jsxDEV(Table, {\n                  hover: true,\n                  className: \"align-middle\",\n                  children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                    className: \"bg-light\",\n                    children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                        style: {\n                          width: '50%'\n                        },\n                        children: \"S\\u1EA3n ph\\u1EA9m\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 247,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                        style: {\n                          width: '15%'\n                        },\n                        children: \"Gi\\xE1\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 248,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                        style: {\n                          width: '20%'\n                        },\n                        children: \"S\\u1ED1 l\\u01B0\\u1EE3ng\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 249,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                        style: {\n                          width: '15%'\n                        },\n                        children: \"T\\u1ED5ng\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 250,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"th\", {}, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 251,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 246,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 245,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                    children: cart.map(item => /*#__PURE__*/_jsxDEV(\"tr\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                        children: /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"d-flex align-items-center\",\n                          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                            src: item.image,\n                            alt: item.name,\n                            style: {\n                              width: '80px',\n                              height: '80px',\n                              objectFit: 'cover'\n                            },\n                            className: \"me-3\",\n                            onError: e => {\n                              e.target.onerror = null;\n                              e.target.src = 'https://via.placeholder.com/80x80?text=No+Image';\n                            }\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 259,\n                            columnNumber: 33\n                          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                            children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n                              className: \"mb-0\",\n                              children: item.name\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 270,\n                              columnNumber: 35\n                            }, this), item.discountPrice && /*#__PURE__*/_jsxDEV(\"span\", {\n                              className: \"badge bg-danger\",\n                              children: \"GI\\u1EA2M GI\\xC1\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 272,\n                              columnNumber: 37\n                            }, this)]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 269,\n                            columnNumber: 33\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 258,\n                          columnNumber: 31\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 257,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: item.discountPrice ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                            className: \"text-decoration-line-through text-muted\",\n                            children: [\"$\", item.price]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 280,\n                            columnNumber: 35\n                          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 281,\n                            columnNumber: 35\n                          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                            className: \"text-danger\",\n                            children: [\"$\", item.discountPrice]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 282,\n                            columnNumber: 35\n                          }, this)]\n                        }, void 0, true) : /*#__PURE__*/_jsxDEV(\"span\", {\n                          children: [\"$\", item.price]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 285,\n                          columnNumber: 33\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 277,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"d-flex align-items-center\",\n                          children: [/*#__PURE__*/_jsxDEV(Button, {\n                            variant: \"outline-secondary\",\n                            size: \"sm\",\n                            onClick: () => handleUpdateQuantity(item.id, item.quantity - 1),\n                            disabled: item.quantity <= 1 || loading,\n                            children: /*#__PURE__*/_jsxDEV(FaMinus, {}, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 296,\n                              columnNumber: 35\n                            }, this)\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 290,\n                            columnNumber: 33\n                          }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                            type: \"number\",\n                            min: \"1\",\n                            max: item.stock,\n                            value: item.quantity,\n                            onChange: e => handleUpdateQuantity(item.id, parseInt(e.target.value) || 1),\n                            className: \"mx-2 text-center\",\n                            style: {\n                              width: '60px'\n                            },\n                            disabled: loading\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 298,\n                            columnNumber: 33\n                          }, this), /*#__PURE__*/_jsxDEV(Button, {\n                            variant: \"outline-secondary\",\n                            size: \"sm\",\n                            onClick: () => handleUpdateQuantity(item.id, item.quantity + 1),\n                            disabled: item.quantity >= item.stock || loading,\n                            children: /*#__PURE__*/_jsxDEV(FaPlus, {}, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 314,\n                              columnNumber: 35\n                            }, this)\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 308,\n                            columnNumber: 33\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 289,\n                          columnNumber: 31\n                        }, this), item.quantity >= item.stock && /*#__PURE__*/_jsxDEV(\"small\", {\n                          className: \"text-danger d-block mt-1\",\n                          children: \"\\u0110\\u1EA1t gi\\u1EDBi h\\u1EA1n kho\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 318,\n                          columnNumber: 33\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 288,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        className: \"fw-bold\",\n                        children: [\"$\", ((item.discountPrice || item.price) * item.quantity).toFixed(2)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 321,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: /*#__PURE__*/_jsxDEV(Button, {\n                          variant: \"outline-danger\",\n                          size: \"sm\",\n                          onClick: () => handleRemoveItem(item.id),\n                          disabled: loading,\n                          children: /*#__PURE__*/_jsxDEV(FaTrash, {}, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 331,\n                            columnNumber: 33\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 325,\n                          columnNumber: 31\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 324,\n                        columnNumber: 29\n                      }, this)]\n                    }, item.id, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 256,\n                      columnNumber: 27\n                    }, this))\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 254,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 244,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 243,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex justify-content-between mt-3\",\n                children: [/*#__PURE__*/_jsxDEV(Link, {\n                  to: \"/products\",\n                  className: \"btn btn-outline-primary\",\n                  children: [/*#__PURE__*/_jsxDEV(FaArrowLeft, {\n                    className: \"me-2\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 342,\n                    columnNumber: 23\n                  }, this), \" Ti\\u1EBFp t\\u1EE5c mua s\\u1EAFm\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 341,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(Button, {\n                  variant: \"outline-danger\",\n                  onClick: () => {\n                    if (window.confirm('Bạn có chắc muốn xóa tất cả sản phẩm khỏi giỏ hàng?')) {\n                      clearCart();\n                    }\n                  },\n                  disabled: loading,\n                  children: [/*#__PURE__*/_jsxDEV(FaTrash, {\n                    className: \"me-2\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 353,\n                    columnNumber: 23\n                  }, this), \" X\\xF3a gi\\u1ECF h\\xE0ng\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 344,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 340,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 242,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 241,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Card, {\n            className: \"shadow-sm\",\n            children: /*#__PURE__*/_jsxDEV(Card.Body, {\n              children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                className: \"mb-3\",\n                children: [/*#__PURE__*/_jsxDEV(FaTag, {\n                  className: \"me-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 362,\n                  columnNumber: 21\n                }, this), \" M\\xE3 gi\\u1EA3m gi\\xE1\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 361,\n                columnNumber: 19\n              }, this), couponApplied ? /*#__PURE__*/_jsxDEV(Alert, {\n                variant: \"success\",\n                children: [\"M\\xE3 gi\\u1EA3m gi\\xE1 \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: couponCode\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 367,\n                  columnNumber: 35\n                }, this), \" \\u0111\\xE3 \\u0111\\u01B0\\u1EE3c \\xE1p d\\u1EE5ng!\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 366,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(InputGroup, {\n                  className: \"mb-3\",\n                  children: [/*#__PURE__*/_jsxDEV(Form.Control, {\n                    placeholder: \"Nh\\u1EADp m\\xE3 gi\\u1EA3m gi\\xE1\",\n                    value: couponCode,\n                    onChange: e => setCouponCode(e.target.value.toUpperCase()),\n                    disabled: loading\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 372,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(Button, {\n                    variant: \"primary\",\n                    onClick: applyCoupon,\n                    disabled: loading,\n                    children: loading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"spinner-border spinner-border-sm me-2\",\n                        role: \"status\",\n                        \"aria-hidden\": \"true\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 385,\n                        columnNumber: 31\n                      }, this), \"\\u0110ang x\\u1EED l\\xFD...\"]\n                    }, void 0, true) : 'Áp dụng'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 378,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 371,\n                  columnNumber: 23\n                }, this), couponError && /*#__PURE__*/_jsxDEV(Alert, {\n                  variant: \"danger\",\n                  children: couponError\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 393,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-muted small\",\n                  children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"mb-1\",\n                    children: \"M\\xE3 gi\\u1EA3m gi\\xE1 m\\u1EABu:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 397,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                    className: \"ps-3\",\n                    children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                      children: \"SALE10 - Gi\\u1EA3m 10% t\\u1ED5ng \\u0111\\u01A1n h\\xE0ng\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 399,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                      children: \"SALE20 - Gi\\u1EA3m 20% t\\u1ED5ng \\u0111\\u01A1n h\\xE0ng\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 400,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                      children: \"FREESHIP - Mi\\u1EC5n ph\\xED v\\u1EADn chuy\\u1EC3n\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 401,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 398,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 396,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 360,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 359,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          lg: 4,\n          children: [/*#__PURE__*/_jsxDEV(Card, {\n            className: \"shadow-sm mb-4\",\n            children: [/*#__PURE__*/_jsxDEV(Card.Header, {\n              className: \"bg-light\",\n              children: /*#__PURE__*/_jsxDEV(\"h5\", {\n                className: \"mb-0\",\n                children: \"Ph\\u01B0\\u01A1ng th\\u1EE9c v\\u1EADn chuy\\u1EC3n\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 413,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 412,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Card.Body, {\n              children: /*#__PURE__*/_jsxDEV(Form, {\n                children: [/*#__PURE__*/_jsxDEV(Form.Check, {\n                  type: \"radio\",\n                  id: \"shipping-standard\",\n                  label: \"Ti\\xEAu chu\\u1EA9n (3-5 ng\\xE0y) - $5.99\",\n                  name: \"shippingMethod\",\n                  value: \"standard\",\n                  checked: shippingMethod === 'standard',\n                  onChange: handleShippingChange,\n                  className: \"mb-2\",\n                  disabled: loading\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 417,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(Form.Check, {\n                  type: \"radio\",\n                  id: \"shipping-express\",\n                  label: \"Nhanh (2-3 ng\\xE0y) - $12.99\",\n                  name: \"shippingMethod\",\n                  value: \"express\",\n                  checked: shippingMethod === 'express',\n                  onChange: handleShippingChange,\n                  className: \"mb-2\",\n                  disabled: loading\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 428,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(Form.Check, {\n                  type: \"radio\",\n                  id: \"shipping-overnight\",\n                  label: \"H\\u1ECFa t\\u1ED1c (1 ng\\xE0y) - $19.99\",\n                  name: \"shippingMethod\",\n                  value: \"overnight\",\n                  checked: shippingMethod === 'overnight',\n                  onChange: handleShippingChange,\n                  disabled: loading\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 439,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 416,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 415,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 411,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Card, {\n            className: \"shadow-sm\",\n            children: [/*#__PURE__*/_jsxDEV(Card.Header, {\n              className: \"bg-light\",\n              children: /*#__PURE__*/_jsxDEV(\"h5\", {\n                className: \"mb-0\",\n                children: \"T\\xF3m t\\u1EAFt \\u0111\\u01A1n h\\xE0ng\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 455,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 454,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Card.Body, {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex justify-content-between mb-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"T\\u1EA1m t\\xEDnh:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 459,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: [\"$\", subTotal.toFixed(2)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 460,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 458,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex justify-content-between mb-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"Ph\\xED v\\u1EADn chuy\\u1EC3n:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 464,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: [\"$\", shippingCost.toFixed(2)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 465,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 463,\n                columnNumber: 19\n              }, this), discount > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex justify-content-between mb-2 text-success\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"Gi\\u1EA3m gi\\xE1:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 470,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: [\"-$\", discount.toFixed(2)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 471,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 469,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 475,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex justify-content-between mb-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"fw-bold\",\n                  children: \"T\\u1ED5ng c\\u1ED9ng:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 478,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"fw-bold fs-5\",\n                  children: [\"$\", total.toFixed(2)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 479,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 477,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                variant: \"primary\",\n                className: \"w-100\",\n                size: \"lg\",\n                onClick: handleCheckout,\n                disabled: loading,\n                children: loading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"spinner-border spinner-border-sm me-2\",\n                    role: \"status\",\n                    \"aria-hidden\": \"true\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 491,\n                    columnNumber: 25\n                  }, this), \"\\u0110ang x\\u1EED l\\xFD...\"]\n                }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(FaCreditCard, {\n                    className: \"me-2\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 496,\n                    columnNumber: 25\n                  }, this), \" Thanh to\\xE1n\"]\n                }, void 0, true)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 482,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-3 text-center\",\n                children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                  src: \"/assets/img/payment-methods.png\",\n                  alt: \"Payment Methods\",\n                  style: {\n                    maxWidth: '100%',\n                    height: 'auto'\n                  },\n                  onError: e => {\n                    e.target.onerror = null;\n                    e.target.src = 'https://via.placeholder.com/250x40?text=Payment+Methods';\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 502,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-muted small mt-2\",\n                  children: \"Ch\\xFAng t\\xF4i ch\\u1EA5p nh\\u1EADn nhi\\u1EC1u ph\\u01B0\\u01A1ng th\\u1EE9c thanh to\\xE1n kh\\xE1c nhau\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 511,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 501,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 457,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 453,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-4\",\n            children: /*#__PURE__*/_jsxDEV(Alert, {\n              variant: \"info\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"me-3\",\n                  children: /*#__PURE__*/_jsxDEV(FaShoppingCart, {\n                    size: 24\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 522,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 521,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Ch\\xEDnh s\\xE1ch mua h\\xE0ng\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 525,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"mb-0 small\",\n                    children: \"Mi\\u1EC5n ph\\xED \\u0111\\u1ED5i tr\\u1EA3 trong v\\xF2ng 30 ng\\xE0y. B\\u1EA3o h\\xE0nh s\\u1EA3n ph\\u1EA9m l\\xEAn \\u0111\\u1EBFn 12 th\\xE1ng.\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 526,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 524,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 520,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 519,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 518,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 410,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 535,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s(Cart, \"cxA1+8YiG1S6cUj5cxfotmWEFu8=\", false, function () {\n  return [useNavigate, useProduct, useAuth];\n});\n_c = Cart;\nexport default Cart;\nvar _c;\n$RefreshReg$(_c, \"Cart\");","map":{"version":3,"names":["React","useState","useEffect","Container","Table","Button","Card","Row","Col","Alert","Form","InputGroup","Link","useNavigate","FaTrash","FaMinus","FaPlus","FaArrowLeft","FaShoppingCart","FaCreditCard","FaTag","Nav","Footer","useProduct","useAuth","jsxDEV","_jsxDEV","Fragment","_Fragment","Cart","_s","navigate","cart","updateCartItem","removeFromCart","clearCart","getCartTotal","isAuthenticated","total","setTotal","subTotal","setSubTotal","couponCode","setCouponCode","discount","setDiscount","couponApplied","setCouponApplied","couponError","setCouponError","shippingMethod","setShippingMethod","shippingCost","setShippingCost","loading","setLoading","itemsTotal","handleUpdateQuantity","id","newQuantity","item","find","stock","alert","error","console","handleRemoveItem","window","confirm","applyCoupon","response","fetch","method","headers","localStorage","getItem","body","JSON","stringify","code","data","json","ok","valid","discountAmount","handleShippingChange","e","target","value","handleCheckout","length","sessionStorage","setItem","items","state","returnUrl","orderSummary","map","product_id","name","price","discountPrice","discount_price","quantity","image","children","fileName","_jsxFileName","lineNumber","columnNumber","className","variant","size","to","lg","Body","hover","style","width","src","alt","height","objectFit","onError","onerror","onClick","disabled","Control","type","min","max","onChange","parseInt","toFixed","placeholder","toUpperCase","role","Header","Check","label","checked","maxWidth","_c","$RefreshReg$"],"sources":["D:/UDW/BaiLam/frontend/src/components/Cart.js"],"sourcesContent":["// src/components/Cart.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Container, Table, Button, Card, Row, Col, Alert, Form, InputGroup } from 'react-bootstrap';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { FaTrash, FaMinus, FaPlus, FaArrowLeft, FaShoppingCart, FaCreditCard, FaTag } from 'react-icons/fa';\r\nimport Nav from './Nav';\r\nimport Footer from './Footer';\r\nimport { useProduct } from '../contexts/ProductContext';\r\nimport { useAuth } from '../contexts/AuthContext';\r\n\r\nfunction Cart() {\r\n  const navigate = useNavigate();\r\n  const { cart, updateCartItem, removeFromCart, clearCart, getCartTotal } = useProduct();\r\n  const { isAuthenticated } = useAuth();\r\n  const [total, setTotal] = useState(0);\r\n  const [subTotal, setSubTotal] = useState(0);\r\n  const [couponCode, setCouponCode] = useState('');\r\n  const [discount, setDiscount] = useState(0);\r\n  const [couponApplied, setCouponApplied] = useState(false);\r\n  const [couponError, setCouponError] = useState('');\r\n  const [shippingMethod, setShippingMethod] = useState('standard');\r\n  const [shippingCost, setShippingCost] = useState(5.99);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  // Tính toán tổng tiền khi giỏ hàng thay đổi\r\n  useEffect(() => {\r\n    const itemsTotal = getCartTotal();\r\n    \r\n    setSubTotal(itemsTotal);\r\n    setTotal(itemsTotal + shippingCost - discount);\r\n  }, [cart, discount, shippingCost, getCartTotal]);\r\n\r\n  // Cập nhật số lượng sản phẩm\r\n  const handleUpdateQuantity = async (id, newQuantity) => {\r\n    if (newQuantity < 1) return;\r\n    \r\n    setLoading(true);\r\n    \r\n    // Tìm sản phẩm để kiểm tra kho hàng\r\n    const item = cart.find(item => item.id === id);\r\n    if (item && newQuantity > item.stock) {\r\n      alert(`Chỉ còn ${item.stock} sản phẩm trong kho!`);\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      await updateCartItem(id, newQuantity);\r\n    } catch (error) {\r\n      console.error('Lỗi khi cập nhật số lượng:', error);\r\n      alert('Không thể cập nhật số lượng sản phẩm. Vui lòng thử lại sau.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Xóa sản phẩm khỏi giỏ hàng\r\n  const handleRemoveItem = async (id) => {\r\n    if (window.confirm('Bạn có chắc muốn xóa sản phẩm này khỏi giỏ hàng?')) {\r\n      setLoading(true);\r\n      try {\r\n        await removeFromCart(id);\r\n      } catch (error) {\r\n        console.error('Lỗi khi xóa sản phẩm:', error);\r\n        alert('Không thể xóa sản phẩm. Vui lòng thử lại sau.');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n  };\r\n\r\n  // Áp dụng mã giảm giá\r\n  const applyCoupon = async () => {\r\n    if (!couponCode) {\r\n      setCouponError('Vui lòng nhập mã giảm giá');\r\n      return;\r\n    }\r\n    \r\n    setLoading(true);\r\n    setCouponError('');\r\n    \r\n    try {\r\n      // Gọi API để kiểm tra và áp dụng mã giảm giá\r\n      const response = await fetch(`http://localhost:5000/api/coupons/check`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\r\n        },\r\n        body: JSON.stringify({ code: couponCode })\r\n      });\r\n      \r\n      const data = await response.json();\r\n      \r\n      if (response.ok && data.valid) {\r\n        const discountAmount = subTotal * (data.discount / 100);\r\n        setDiscount(discountAmount);\r\n        setCouponApplied(true);\r\n      } else {\r\n        // Nếu không có API hoặc API không trả về kết quả hợp lệ, sử dụng mã giảm giá mẫu\r\n        if (couponCode === 'SALE10') {\r\n          const discountAmount = subTotal * 0.1;\r\n          setDiscount(discountAmount);\r\n          setCouponApplied(true);\r\n        } else if (couponCode === 'SALE20') {\r\n          const discountAmount = subTotal * 0.2;\r\n          setDiscount(discountAmount);\r\n          setCouponApplied(true);\r\n        } else if (couponCode === 'FREESHIP') {\r\n          setShippingCost(0);\r\n          setCouponApplied(true);\r\n        } else {\r\n          setCouponError('Mã giảm giá không hợp lệ hoặc đã hết hạn');\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Lỗi khi áp dụng mã giảm giá:', error);\r\n      setCouponError('Không thể áp dụng mã giảm giá. Vui lòng thử lại.');\r\n      \r\n      // Fallback sử dụng mã giảm giá mẫu nếu không kết nối được API\r\n      if (couponCode === 'SALE10') {\r\n        const discountAmount = subTotal * 0.1;\r\n        setDiscount(discountAmount);\r\n        setCouponApplied(true);\r\n      } else if (couponCode === 'SALE20') {\r\n        const discountAmount = subTotal * 0.2;\r\n        setDiscount(discountAmount);\r\n        setCouponApplied(true);\r\n      } else if (couponCode === 'FREESHIP') {\r\n        setShippingCost(0);\r\n        setCouponApplied(true);\r\n      } else {\r\n        setCouponError('Mã giảm giá không hợp lệ hoặc đã hết hạn');\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Xử lý thay đổi phương thức vận chuyển\r\n  const handleShippingChange = (e) => {\r\n    const method = e.target.value;\r\n    setShippingMethod(method);\r\n    \r\n    switch(method) {\r\n      case 'express':\r\n        setShippingCost(12.99);\r\n        break;\r\n      case 'overnight':\r\n        setShippingCost(19.99);\r\n        break;\r\n      case 'standard':\r\n      default:\r\n        setShippingCost(5.99);\r\n    }\r\n  };\r\n\r\n// Thay đổi phần xử lý checkout để đồng bộ với API\r\n\r\nconst handleCheckout = () => {\r\n  if (cart.length === 0) {\r\n    alert('Giỏ hàng của bạn đang trống!');\r\n    return;\r\n  }\r\n  \r\n  if (!isAuthenticated) {\r\n    // Lưu thông tin đơn hàng vào sessionStorage để khôi phục sau khi đăng nhập\r\n    sessionStorage.setItem('pendingCheckout', JSON.stringify({\r\n      items: cart,\r\n      subTotal,\r\n      discount,\r\n      shippingCost,\r\n      total,\r\n      shippingMethod\r\n    }));\r\n    \r\n    if (window.confirm('Bạn cần đăng nhập để tiếp tục thanh toán. Chuyển đến trang đăng nhập?')) {\r\n      navigate('/login', { state: { returnUrl: '/checkout' } });\r\n    }\r\n    return;\r\n  }\r\n  \r\n  try {\r\n    // Chuẩn bị thông tin đơn hàng\r\n    const orderSummary = {\r\n      items: cart.map(item => ({\r\n        id: item.id,\r\n        product_id: item.id,\r\n        name: item.name,\r\n        price: item.price,\r\n        discountPrice: item.discountPrice || item.discount_price,\r\n        quantity: item.quantity,\r\n        image: item.image,\r\n        stock: item.stock\r\n      })),\r\n      subTotal,\r\n      discount,\r\n      shippingCost,\r\n      total,\r\n      shippingMethod\r\n    };\r\n    \r\n    // Lưu vào sessionStorage để sử dụng ở trang Checkout\r\n    sessionStorage.setItem('orderSummary', JSON.stringify(orderSummary));\r\n    \r\n    // Chuyển đến trang thanh toán\r\n    navigate('/checkout');\r\n  } catch (error) {\r\n    console.error('Error during checkout preparation:', error);\r\n    alert('Có lỗi xảy ra khi chuẩn bị thanh toán. Vui lòng thử lại.');\r\n  }\r\n};\r\n\r\n  return (\r\n    <>\r\n      <Nav />\r\n      <Container className=\"py-5 mt-5\">\r\n        <h2 className=\"mb-4\">\r\n          <FaShoppingCart className=\"me-2\" />\r\n          Giỏ hàng của bạn\r\n        </h2>\r\n        \r\n        {cart.length === 0 ? (\r\n          <Row>\r\n            <Col>\r\n              <Alert variant=\"info\">\r\n                <div className=\"text-center py-4\">\r\n                  <FaShoppingCart size={50} className=\"mb-3 text-muted\" />\r\n                  <h4>Giỏ hàng của bạn đang trống</h4>\r\n                  <p className=\"mb-4\">Hãy thêm sản phẩm vào giỏ hàng để tiếp tục mua sắm.</p>\r\n                  <Link to=\"/products\" className=\"btn btn-primary\">\r\n                    <FaArrowLeft className=\"me-2\" /> Tiếp tục mua sắm\r\n                  </Link>\r\n                </div>\r\n              </Alert>\r\n            </Col>\r\n          </Row>\r\n        ) : (\r\n          <Row>\r\n            <Col lg={8}>\r\n              <Card className=\"mb-4 shadow-sm\">\r\n                <Card.Body>\r\n                  <div className=\"table-responsive\">\r\n                    <Table hover className=\"align-middle\">\r\n                      <thead className=\"bg-light\">\r\n                        <tr>\r\n                          <th style={{ width: '50%' }}>Sản phẩm</th>\r\n                          <th style={{ width: '15%' }}>Giá</th>\r\n                          <th style={{ width: '20%' }}>Số lượng</th>\r\n                          <th style={{ width: '15%' }}>Tổng</th>\r\n                          <th></th>\r\n                        </tr>\r\n                      </thead>\r\n                      <tbody>\r\n                        {cart.map((item) => (\r\n                          <tr key={item.id}>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center\">\r\n                                <img \r\n                                  src={item.image} \r\n                                  alt={item.name} \r\n                                  style={{ width: '80px', height: '80px', objectFit: 'cover' }}\r\n                                  className=\"me-3\"\r\n                                  onError={(e) => {\r\n                                    e.target.onerror = null;\r\n                                    e.target.src = 'https://via.placeholder.com/80x80?text=No+Image';\r\n                                  }}\r\n                                />\r\n                                <div>\r\n                                  <h6 className=\"mb-0\">{item.name}</h6>\r\n                                  {item.discountPrice && (\r\n                                    <span className=\"badge bg-danger\">GIẢM GIÁ</span>\r\n                                  )}\r\n                                </div>\r\n                              </div>\r\n                            </td>\r\n                            <td>\r\n                              {item.discountPrice ? (\r\n                                <>\r\n                                  <span className=\"text-decoration-line-through text-muted\">${item.price}</span>\r\n                                  <br />\r\n                                  <span className=\"text-danger\">${item.discountPrice}</span>\r\n                                </>\r\n                              ) : (\r\n                                <span>${item.price}</span>\r\n                              )}\r\n                            </td>\r\n                            <td>\r\n                              <div className=\"d-flex align-items-center\">\r\n                                <Button \r\n                                  variant=\"outline-secondary\" \r\n                                  size=\"sm\"\r\n                                  onClick={() => handleUpdateQuantity(item.id, item.quantity - 1)}\r\n                                  disabled={item.quantity <= 1 || loading}\r\n                                >\r\n                                  <FaMinus />\r\n                                </Button>\r\n                                <Form.Control\r\n                                  type=\"number\"\r\n                                  min=\"1\"\r\n                                  max={item.stock}\r\n                                  value={item.quantity}\r\n                                  onChange={(e) => handleUpdateQuantity(item.id, parseInt(e.target.value) || 1)}\r\n                                  className=\"mx-2 text-center\"\r\n                                  style={{ width: '60px' }}\r\n                                  disabled={loading}\r\n                                />\r\n                                <Button \r\n                                  variant=\"outline-secondary\" \r\n                                  size=\"sm\"\r\n                                  onClick={() => handleUpdateQuantity(item.id, item.quantity + 1)}\r\n                                  disabled={item.quantity >= item.stock || loading}\r\n                                >\r\n                                  <FaPlus />\r\n                                </Button>\r\n                              </div>\r\n                              {item.quantity >= item.stock && (\r\n                                <small className=\"text-danger d-block mt-1\">Đạt giới hạn kho</small>\r\n                              )}\r\n                            </td>\r\n                            <td className=\"fw-bold\">\r\n                              ${((item.discountPrice || item.price) * item.quantity).toFixed(2)}\r\n                            </td>\r\n                            <td>\r\n                              <Button \r\n                                variant=\"outline-danger\" \r\n                                size=\"sm\"\r\n                                onClick={() => handleRemoveItem(item.id)}\r\n                                disabled={loading}\r\n                              >\r\n                                <FaTrash />\r\n                              </Button>\r\n                            </td>\r\n                          </tr>\r\n                        ))}\r\n                      </tbody>\r\n                    </Table>\r\n                  </div>\r\n                  \r\n                  <div className=\"d-flex justify-content-between mt-3\">\r\n                    <Link to=\"/products\" className=\"btn btn-outline-primary\">\r\n                      <FaArrowLeft className=\"me-2\" /> Tiếp tục mua sắm\r\n                    </Link>\r\n                    <Button \r\n                      variant=\"outline-danger\" \r\n                      onClick={() => {\r\n                        if (window.confirm('Bạn có chắc muốn xóa tất cả sản phẩm khỏi giỏ hàng?')) {\r\n                          clearCart();\r\n                        }\r\n                      }}\r\n                      disabled={loading}\r\n                    >\r\n                      <FaTrash className=\"me-2\" /> Xóa giỏ hàng\r\n                    </Button>\r\n                  </div>\r\n                </Card.Body>\r\n              </Card>\r\n              \r\n              <Card className=\"shadow-sm\">\r\n                <Card.Body>\r\n                  <h5 className=\"mb-3\">\r\n                    <FaTag className=\"me-2\" /> Mã giảm giá\r\n                  </h5>\r\n                  \r\n                  {couponApplied ? (\r\n                    <Alert variant=\"success\">\r\n                      Mã giảm giá <strong>{couponCode}</strong> đã được áp dụng!\r\n                    </Alert>\r\n                  ) : (\r\n                    <>\r\n                      <InputGroup className=\"mb-3\">\r\n                        <Form.Control\r\n                          placeholder=\"Nhập mã giảm giá\"\r\n                          value={couponCode}\r\n                          onChange={(e) => setCouponCode(e.target.value.toUpperCase())}\r\n                          disabled={loading}\r\n                        />\r\n                        <Button \r\n                          variant=\"primary\" \r\n                          onClick={applyCoupon}\r\n                          disabled={loading}\r\n                        >\r\n                          {loading ? (\r\n                            <>\r\n                              <span className=\"spinner-border spinner-border-sm me-2\" role=\"status\" aria-hidden=\"true\"></span>\r\n                              Đang xử lý...\r\n                            </>\r\n                          ) : 'Áp dụng'}\r\n                        </Button>\r\n                      </InputGroup>\r\n                      \r\n                      {couponError && (\r\n                        <Alert variant=\"danger\">{couponError}</Alert>\r\n                      )}\r\n                      \r\n                      <div className=\"text-muted small\">\r\n                        <p className=\"mb-1\">Mã giảm giá mẫu:</p>\r\n                        <ul className=\"ps-3\">\r\n                          <li>SALE10 - Giảm 10% tổng đơn hàng</li>\r\n                          <li>SALE20 - Giảm 20% tổng đơn hàng</li>\r\n                          <li>FREESHIP - Miễn phí vận chuyển</li>\r\n                        </ul>\r\n                      </div>\r\n                    </>\r\n                  )}\r\n                </Card.Body>\r\n              </Card>\r\n            </Col>\r\n            \r\n            <Col lg={4}>\r\n              <Card className=\"shadow-sm mb-4\">\r\n                <Card.Header className=\"bg-light\">\r\n                  <h5 className=\"mb-0\">Phương thức vận chuyển</h5>\r\n                </Card.Header>\r\n                <Card.Body>\r\n                  <Form>\r\n                    <Form.Check\r\n                      type=\"radio\"\r\n                      id=\"shipping-standard\"\r\n                      label=\"Tiêu chuẩn (3-5 ngày) - $5.99\"\r\n                      name=\"shippingMethod\"\r\n                      value=\"standard\"\r\n                      checked={shippingMethod === 'standard'}\r\n                      onChange={handleShippingChange}\r\n                      className=\"mb-2\"\r\n                      disabled={loading}\r\n                    />\r\n                    <Form.Check\r\n                      type=\"radio\"\r\n                      id=\"shipping-express\"\r\n                      label=\"Nhanh (2-3 ngày) - $12.99\"\r\n                      name=\"shippingMethod\"\r\n                      value=\"express\"\r\n                      checked={shippingMethod === 'express'}\r\n                      onChange={handleShippingChange}\r\n                      className=\"mb-2\"\r\n                      disabled={loading}\r\n                    />\r\n                    <Form.Check\r\n                      type=\"radio\"\r\n                      id=\"shipping-overnight\"\r\n                      label=\"Hỏa tốc (1 ngày) - $19.99\"\r\n                      name=\"shippingMethod\"\r\n                      value=\"overnight\"\r\n                      checked={shippingMethod === 'overnight'}\r\n                      onChange={handleShippingChange}\r\n                      disabled={loading}\r\n                    />\r\n                  </Form>\r\n                </Card.Body>\r\n              </Card>\r\n              \r\n              <Card className=\"shadow-sm\">\r\n                <Card.Header className=\"bg-light\">\r\n                  <h5 className=\"mb-0\">Tóm tắt đơn hàng</h5>\r\n                </Card.Header>\r\n                <Card.Body>\r\n                  <div className=\"d-flex justify-content-between mb-2\">\r\n                    <span>Tạm tính:</span>\r\n                    <span>${subTotal.toFixed(2)}</span>\r\n                  </div>\r\n                  \r\n                  <div className=\"d-flex justify-content-between mb-2\">\r\n                    <span>Phí vận chuyển:</span>\r\n                    <span>${shippingCost.toFixed(2)}</span>\r\n                  </div>\r\n                  \r\n                  {discount > 0 && (\r\n                    <div className=\"d-flex justify-content-between mb-2 text-success\">\r\n                      <span>Giảm giá:</span>\r\n                      <span>-${discount.toFixed(2)}</span>\r\n                    </div>\r\n                  )}\r\n                  \r\n                  <hr />\r\n                  \r\n                  <div className=\"d-flex justify-content-between mb-3\">\r\n                    <span className=\"fw-bold\">Tổng cộng:</span>\r\n                    <span className=\"fw-bold fs-5\">${total.toFixed(2)}</span>\r\n                  </div>\r\n                  \r\n                  <Button \r\n                    variant=\"primary\" \r\n                    className=\"w-100\" \r\n                    size=\"lg\"\r\n                    onClick={handleCheckout}\r\n                    disabled={loading}\r\n                  >\r\n                    {loading ? (\r\n                      <>\r\n                        <span className=\"spinner-border spinner-border-sm me-2\" role=\"status\" aria-hidden=\"true\"></span>\r\n                        Đang xử lý...\r\n                      </>\r\n                    ) : (\r\n                      <>\r\n                        <FaCreditCard className=\"me-2\" /> Thanh toán\r\n                      </>\r\n                    )}\r\n                  </Button>\r\n                  \r\n                  <div className=\"mt-3 text-center\">\r\n                    <img \r\n                      src=\"/assets/img/payment-methods.png\" \r\n                      alt=\"Payment Methods\" \r\n                      style={{ maxWidth: '100%', height: 'auto' }}\r\n                      onError={(e) => {\r\n                        e.target.onerror = null;\r\n                        e.target.src = 'https://via.placeholder.com/250x40?text=Payment+Methods';\r\n                      }}\r\n                    />\r\n                    <p className=\"text-muted small mt-2\">\r\n                      Chúng tôi chấp nhận nhiều phương thức thanh toán khác nhau\r\n                    </p>\r\n                  </div>\r\n                </Card.Body>\r\n              </Card>\r\n              \r\n              <div className=\"mt-4\">\r\n                <Alert variant=\"info\">\r\n                  <div className=\"d-flex\">\r\n                    <div className=\"me-3\">\r\n                      <FaShoppingCart size={24} />\r\n                    </div>\r\n                    <div>\r\n                      <strong>Chính sách mua hàng</strong>\r\n                      <p className=\"mb-0 small\">Miễn phí đổi trả trong vòng 30 ngày. Bảo hành sản phẩm lên đến 12 tháng.</p>\r\n                    </div>\r\n                  </div>\r\n                </Alert>\r\n              </div>\r\n            </Col>\r\n          </Row>\r\n        )}\r\n      </Container>\r\n      <Footer />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Cart;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}