{"ast":null,"code":"var _jsxFileName = \"D:\\\\UDW\\\\BaiLam\\\\frontend\\\\src\\\\contexts\\\\ProductContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// src/contexts/ProductContext.js\nimport React, { createContext, useState, useEffect, useContext } from 'react';\nimport { productApi, categoryApi, cartApi } from '../services/api';\nimport { useAuth } from './AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProductContext = /*#__PURE__*/createContext();\nexport const useProduct = () => {\n  _s();\n  return useContext(ProductContext);\n};\n_s(useProduct, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport const ProductProvider = ({\n  children\n}) => {\n  _s2();\n  const {\n    isAuthenticated,\n    currentUser\n  } = useAuth();\n  const [products, setProducts] = useState([]);\n  const [categories, setCategories] = useState([]);\n  const [cart, setCart] = useState([]);\n  const [wishlist, setWishlist] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Khởi tạo dữ liệu\n  useEffect(() => {\n    const fetchInitialData = async () => {\n      try {\n        setIsLoading(true);\n\n        // Lấy danh sách danh mục từ API\n        try {\n          const categoriesResponse = await categoryApi.getAll();\n          if (categoriesResponse.data && categoriesResponse.data.length > 0) {\n            setCategories(categoriesResponse.data);\n          } else {\n            setError('Không thể tải danh mục sản phẩm');\n          }\n        } catch (categoryError) {\n          console.error('Không thể lấy danh mục từ API:', categoryError);\n          setError('Không thể tải danh mục sản phẩm. Vui lòng tải lại trang.');\n        }\n\n        // Lấy danh sách sản phẩm từ API\n        try {\n          const productsResponse = await productApi.getAll();\n          if (productsResponse.data && productsResponse.data.length > 0) {\n            setProducts(productsResponse.data);\n          } else {\n            setError('Không tìm thấy sản phẩm nào');\n          }\n        } catch (productError) {\n          console.error('Không thể lấy sản phẩm từ API:', productError);\n          setError('Không thể tải sản phẩm. Vui lòng tải lại trang.');\n        }\n\n        // Nếu đã đăng nhập, lấy giỏ hàng và wishlist từ server\n        if (isAuthenticated && currentUser) {\n          try {\n            // Nếu có API lấy giỏ hàng\n            const cartResponse = await cartApi.getCart();\n            if (cartResponse.data) {\n              setCart(cartResponse.data);\n            }\n\n            // Nếu có API lấy wishlist\n            const wishlistResponse = await cartApi.getWishlist();\n            if (wishlistResponse.data) {\n              setWishlist(wishlistResponse.data);\n            }\n          } catch (userDataError) {\n            console.error('Không thể lấy dữ liệu người dùng:', userDataError);\n\n            // Sử dụng dữ liệu từ localStorage nếu API fail\n            const savedCart = localStorage.getItem('cart');\n            const savedWishlist = localStorage.getItem('wishlist');\n            if (savedCart) {\n              setCart(JSON.parse(savedCart));\n            }\n            if (savedWishlist) {\n              setWishlist(JSON.parse(savedWishlist));\n            }\n          }\n        } else {\n          // Nếu chưa đăng nhập, lấy từ localStorage\n          const savedCart = localStorage.getItem('cart');\n          const savedWishlist = localStorage.getItem('wishlist');\n          if (savedCart) {\n            setCart(JSON.parse(savedCart));\n          }\n          if (savedWishlist) {\n            setWishlist(JSON.parse(savedWishlist));\n          }\n        }\n      } catch (err) {\n        console.error('Lỗi khi khởi tạo dữ liệu:', err);\n        setError('Không thể tải dữ liệu ban đầu. Vui lòng tải lại trang.');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    fetchInitialData();\n  }, [isAuthenticated, currentUser]);\n\n  // Lưu giỏ hàng vào localStorage khi thay đổi\n  useEffect(() => {\n    if (!isLoading) {\n      localStorage.setItem('cart', JSON.stringify(cart));\n    }\n  }, [cart, isLoading]);\n\n  // Lưu danh sách yêu thích vào localStorage khi thay đổi\n  useEffect(() => {\n    if (!isLoading) {\n      localStorage.setItem('wishlist', JSON.stringify(wishlist));\n    }\n  }, [wishlist, isLoading]);\n\n  // Thêm sản phẩm vào giỏ hàng\n  const addToCart = async (product, quantity = 1) => {\n    try {\n      const existingItemIndex = cart.findIndex(item => item.id === product.id);\n      let updatedCart = [...cart];\n      if (existingItemIndex !== -1) {\n        // Cập nhật số lượng nếu sản phẩm đã có trong giỏ hàng\n        updatedCart[existingItemIndex].quantity += quantity;\n      } else {\n        // Thêm sản phẩm mới vào giỏ hàng\n        updatedCart = [...cart, {\n          ...product,\n          quantity\n        }];\n      }\n\n      // Cập nhật state\n      setCart(updatedCart);\n\n      // Nếu đã đăng nhập, đồng bộ với server\n      if (isAuthenticated && currentUser) {\n        try {\n          if (existingItemIndex !== -1) {\n            // Cập nhật sản phẩm đã có\n            await cartApi.updateItem(product.id, updatedCart[existingItemIndex].quantity);\n          } else {\n            // Thêm sản phẩm mới\n            await cartApi.addItem({\n              productId: product.id,\n              quantity: quantity\n            });\n          }\n        } catch (apiError) {\n          console.error('Lỗi khi cập nhật giỏ hàng trên server:', apiError);\n        }\n      }\n    } catch (error) {\n      console.error('Lỗi khi thêm vào giỏ hàng:', error);\n      setError('Không thể thêm sản phẩm vào giỏ hàng. Vui lòng thử lại.');\n    }\n  };\n\n  // Cập nhật số lượng sản phẩm trong giỏ hàng\n  const updateCartItem = async (productId, quantity) => {\n    try {\n      if (quantity <= 0) {\n        return removeFromCart(productId);\n      }\n\n      // Cập nhật state\n      const updatedCart = cart.map(item => item.id === productId ? {\n        ...item,\n        quantity\n      } : item);\n      setCart(updatedCart);\n\n      // Nếu đã đăng nhập, đồng bộ với server\n      if (isAuthenticated && currentUser) {\n        try {\n          await cartApi.updateItem(productId, quantity);\n        } catch (apiError) {\n          console.error('Lỗi khi cập nhật số lượng sản phẩm trên server:', apiError);\n        }\n      }\n    } catch (error) {\n      console.error('Lỗi khi cập nhật giỏ hàng:', error);\n      setError('Không thể cập nhật giỏ hàng. Vui lòng thử lại.');\n    }\n  };\n\n  // Xóa sản phẩm khỏi giỏ hàng\n  const removeFromCart = async productId => {\n    try {\n      // Cập nhật state\n      setCart(cart.filter(item => item.id !== productId));\n\n      // Nếu đã đăng nhập, đồng bộ với server\n      if (isAuthenticated && currentUser) {\n        try {\n          await cartApi.removeItem(productId);\n        } catch (apiError) {\n          console.error('Lỗi khi xóa sản phẩm khỏi giỏ hàng trên server:', apiError);\n        }\n      }\n    } catch (error) {\n      console.error('Lỗi khi xóa khỏi giỏ hàng:', error);\n      setError('Không thể xóa sản phẩm khỏi giỏ hàng. Vui lòng thử lại.');\n    }\n  };\n\n  // Xóa toàn bộ giỏ hàng\n  const clearCart = async () => {\n    try {\n      // Cập nhật state\n      setCart([]);\n\n      // Nếu đã đăng nhập, đồng bộ với server\n      if (isAuthenticated && currentUser) {\n        try {\n          await cartApi.clearCart();\n        } catch (apiError) {\n          console.error('Lỗi khi xóa toàn bộ giỏ hàng trên server:', apiError);\n        }\n      }\n    } catch (error) {\n      console.error('Lỗi khi xóa giỏ hàng:', error);\n      setError('Không thể xóa giỏ hàng. Vui lòng thử lại.');\n    }\n  };\n\n  // Thêm vào danh sách yêu thích\n  const addToWishlist = async product => {\n    try {\n      // Kiểm tra sản phẩm đã có trong wishlist chưa\n      if (!wishlist.some(item => item.id === product.id)) {\n        // Cập nhật state\n        setWishlist([...wishlist, product]);\n\n        // Nếu đã đăng nhập, đồng bộ với server\n        if (isAuthenticated && currentUser) {\n          try {\n            await cartApi.addToWishlist(product.id);\n          } catch (apiError) {\n            console.error('Lỗi khi thêm sản phẩm vào wishlist trên server:', apiError);\n          }\n        }\n      }\n    } catch (error) {\n      console.error('Lỗi khi thêm vào danh sách yêu thích:', error);\n      setError('Không thể thêm vào danh sách yêu thích. Vui lòng thử lại.');\n    }\n  };\n\n  // Xóa khỏi danh sách yêu thích\n  const removeFromWishlist = async productId => {\n    try {\n      // Cập nhật state\n      setWishlist(wishlist.filter(item => item.id !== productId));\n\n      // Nếu đã đăng nhập, đồng bộ với server\n      if (isAuthenticated && currentUser) {\n        try {\n          await cartApi.removeFromWishlist(productId);\n        } catch (apiError) {\n          console.error('Lỗi khi xóa sản phẩm khỏi wishlist trên server:', apiError);\n        }\n      }\n    } catch (error) {\n      console.error('Lỗi khi xóa khỏi danh sách yêu thích:', error);\n      setError('Không thể xóa khỏi danh sách yêu thích. Vui lòng thử lại.');\n    }\n  };\n\n  // Tính tổng giá trị giỏ hàng\n  const getCartTotal = () => {\n    try {\n      return cart.reduce((total, item) => {\n        const price = item.discount_price || item.price;\n        return total + price * item.quantity;\n      }, 0);\n    } catch (error) {\n      console.error('Lỗi khi tính tổng giỏ hàng:', error);\n      return 0;\n    }\n  };\n\n  // Lấy sản phẩm theo ID\n  const getProductById = async id => {\n    try {\n      setIsLoading(true);\n\n      // Gọi API để lấy chi tiết sản phẩm\n      const response = await productApi.getById(id);\n      return response;\n    } catch (err) {\n      console.error(`Lỗi khi lấy thông tin sản phẩm ${id}:`, err);\n      setError('Không thể tải thông tin sản phẩm. Vui lòng thử lại.');\n      return Promise.reject(err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Lấy sản phẩm theo danh mục\n  const getProductsByCategory = async categoryId => {\n    try {\n      setIsLoading(true);\n\n      // Gọi API để lấy sản phẩm theo danh mục\n      const response = await productApi.getByCategory(categoryId);\n      return response;\n    } catch (err) {\n      console.error(`Lỗi khi lấy sản phẩm theo danh mục:`, err);\n      setError('Không thể tải sản phẩm theo danh mục. Vui lòng thử lại.');\n      return Promise.reject(err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Tìm kiếm sản phẩm\n  const searchProducts = async query => {\n    try {\n      setIsLoading(true);\n\n      // Gọi API để tìm kiếm sản phẩm\n      const response = await productApi.search(query);\n      return response;\n    } catch (err) {\n      console.error(`Lỗi khi tìm kiếm sản phẩm:`, err);\n      setError('Không thể tìm kiếm sản phẩm. Vui lòng thử lại.');\n      return Promise.reject(err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Các giá trị và hàm được cung cấp qua context\n  const value = {\n    products,\n    categories,\n    cart,\n    wishlist,\n    isLoading,\n    error,\n    addToCart,\n    updateCartItem,\n    removeFromCart,\n    clearCart,\n    addToWishlist,\n    removeFromWishlist,\n    getCartTotal,\n    getProductById,\n    getProductsByCategory,\n    searchProducts\n  };\n  return /*#__PURE__*/_jsxDEV(ProductContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 353,\n    columnNumber: 5\n  }, this);\n};\n_s2(ProductProvider, \"WF/c9cNbtkAfyRrXdP5pAb7F3f8=\", false, function () {\n  return [useAuth];\n});\n_c = ProductProvider;\nvar _c;\n$RefreshReg$(_c, \"ProductProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","useContext","productApi","categoryApi","cartApi","useAuth","jsxDEV","_jsxDEV","ProductContext","useProduct","_s","ProductProvider","children","_s2","isAuthenticated","currentUser","products","setProducts","categories","setCategories","cart","setCart","wishlist","setWishlist","isLoading","setIsLoading","error","setError","fetchInitialData","categoriesResponse","getAll","data","length","categoryError","console","productsResponse","productError","cartResponse","getCart","wishlistResponse","getWishlist","userDataError","savedCart","localStorage","getItem","savedWishlist","JSON","parse","err","setItem","stringify","addToCart","product","quantity","existingItemIndex","findIndex","item","id","updatedCart","updateItem","addItem","productId","apiError","updateCartItem","removeFromCart","map","filter","removeItem","clearCart","addToWishlist","some","removeFromWishlist","getCartTotal","reduce","total","price","discount_price","getProductById","response","getById","Promise","reject","getProductsByCategory","categoryId","getByCategory","searchProducts","query","search","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/UDW/BaiLam/frontend/src/contexts/ProductContext.js"],"sourcesContent":["// src/contexts/ProductContext.js\r\nimport React, { createContext, useState, useEffect, useContext } from 'react';\r\nimport { productApi, categoryApi, cartApi } from '../services/api';\r\nimport { useAuth } from './AuthContext';\r\n\r\nconst ProductContext = createContext();\r\n\r\nexport const useProduct = () => useContext(ProductContext);\r\n\r\nexport const ProductProvider = ({ children }) => {\r\n  const { isAuthenticated, currentUser } = useAuth();\r\n  const [products, setProducts] = useState([]);\r\n  const [categories, setCategories] = useState([]);\r\n  const [cart, setCart] = useState([]);\r\n  const [wishlist, setWishlist] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  // Khởi tạo dữ liệu\r\n  useEffect(() => {\r\n    const fetchInitialData = async () => {\r\n      try {\r\n        setIsLoading(true);\r\n        \r\n        // Lấy danh sách danh mục từ API\r\n        try {\r\n          const categoriesResponse = await categoryApi.getAll();\r\n          if (categoriesResponse.data && categoriesResponse.data.length > 0) {\r\n            setCategories(categoriesResponse.data);\r\n          } else {\r\n            setError('Không thể tải danh mục sản phẩm');\r\n          }\r\n        } catch (categoryError) {\r\n          console.error('Không thể lấy danh mục từ API:', categoryError);\r\n          setError('Không thể tải danh mục sản phẩm. Vui lòng tải lại trang.');\r\n        }\r\n        \r\n        // Lấy danh sách sản phẩm từ API\r\n        try {\r\n          const productsResponse = await productApi.getAll();\r\n          if (productsResponse.data && productsResponse.data.length > 0) {\r\n            setProducts(productsResponse.data);\r\n          } else {\r\n            setError('Không tìm thấy sản phẩm nào');\r\n          }\r\n        } catch (productError) {\r\n          console.error('Không thể lấy sản phẩm từ API:', productError);\r\n          setError('Không thể tải sản phẩm. Vui lòng tải lại trang.');\r\n        }\r\n        \r\n        // Nếu đã đăng nhập, lấy giỏ hàng và wishlist từ server\r\n        if (isAuthenticated && currentUser) {\r\n          try {\r\n            // Nếu có API lấy giỏ hàng\r\n            const cartResponse = await cartApi.getCart();\r\n            if (cartResponse.data) {\r\n              setCart(cartResponse.data);\r\n            }\r\n            \r\n            // Nếu có API lấy wishlist\r\n            const wishlistResponse = await cartApi.getWishlist();\r\n            if (wishlistResponse.data) {\r\n              setWishlist(wishlistResponse.data);\r\n            }\r\n          } catch (userDataError) {\r\n            console.error('Không thể lấy dữ liệu người dùng:', userDataError);\r\n            \r\n            // Sử dụng dữ liệu từ localStorage nếu API fail\r\n            const savedCart = localStorage.getItem('cart');\r\n            const savedWishlist = localStorage.getItem('wishlist');\r\n            \r\n            if (savedCart) {\r\n              setCart(JSON.parse(savedCart));\r\n            }\r\n            \r\n            if (savedWishlist) {\r\n              setWishlist(JSON.parse(savedWishlist));\r\n            }\r\n          }\r\n        } else {\r\n          // Nếu chưa đăng nhập, lấy từ localStorage\r\n          const savedCart = localStorage.getItem('cart');\r\n          const savedWishlist = localStorage.getItem('wishlist');\r\n          \r\n          if (savedCart) {\r\n            setCart(JSON.parse(savedCart));\r\n          }\r\n          \r\n          if (savedWishlist) {\r\n            setWishlist(JSON.parse(savedWishlist));\r\n          }\r\n        }\r\n      } catch (err) {\r\n        console.error('Lỗi khi khởi tạo dữ liệu:', err);\r\n        setError('Không thể tải dữ liệu ban đầu. Vui lòng tải lại trang.');\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n    \r\n    fetchInitialData();\r\n  }, [isAuthenticated, currentUser]);\r\n\r\n  // Lưu giỏ hàng vào localStorage khi thay đổi\r\n  useEffect(() => {\r\n    if (!isLoading) {\r\n      localStorage.setItem('cart', JSON.stringify(cart));\r\n    }\r\n  }, [cart, isLoading]);\r\n\r\n  // Lưu danh sách yêu thích vào localStorage khi thay đổi\r\n  useEffect(() => {\r\n    if (!isLoading) {\r\n      localStorage.setItem('wishlist', JSON.stringify(wishlist));\r\n    }\r\n  }, [wishlist, isLoading]);\r\n\r\n  // Thêm sản phẩm vào giỏ hàng\r\n  const addToCart = async (product, quantity = 1) => {\r\n    try {\r\n      const existingItemIndex = cart.findIndex(item => item.id === product.id);\r\n      let updatedCart = [...cart];\r\n      \r\n      if (existingItemIndex !== -1) {\r\n        // Cập nhật số lượng nếu sản phẩm đã có trong giỏ hàng\r\n        updatedCart[existingItemIndex].quantity += quantity;\r\n      } else {\r\n        // Thêm sản phẩm mới vào giỏ hàng\r\n        updatedCart = [...cart, { ...product, quantity }];\r\n      }\r\n      \r\n      // Cập nhật state\r\n      setCart(updatedCart);\r\n      \r\n      // Nếu đã đăng nhập, đồng bộ với server\r\n      if (isAuthenticated && currentUser) {\r\n        try {\r\n          if (existingItemIndex !== -1) {\r\n            // Cập nhật sản phẩm đã có\r\n            await cartApi.updateItem(product.id, updatedCart[existingItemIndex].quantity);\r\n          } else {\r\n            // Thêm sản phẩm mới\r\n            await cartApi.addItem({\r\n              productId: product.id,\r\n              quantity: quantity\r\n            });\r\n          }\r\n        } catch (apiError) {\r\n          console.error('Lỗi khi cập nhật giỏ hàng trên server:', apiError);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Lỗi khi thêm vào giỏ hàng:', error);\r\n      setError('Không thể thêm sản phẩm vào giỏ hàng. Vui lòng thử lại.');\r\n    }\r\n  };\r\n\r\n  // Cập nhật số lượng sản phẩm trong giỏ hàng\r\n  const updateCartItem = async (productId, quantity) => {\r\n    try {\r\n      if (quantity <= 0) {\r\n        return removeFromCart(productId);\r\n      }\r\n      \r\n      // Cập nhật state\r\n      const updatedCart = cart.map(item => \r\n        item.id === productId ? { ...item, quantity } : item\r\n      );\r\n      setCart(updatedCart);\r\n      \r\n      // Nếu đã đăng nhập, đồng bộ với server\r\n      if (isAuthenticated && currentUser) {\r\n        try {\r\n          await cartApi.updateItem(productId, quantity);\r\n        } catch (apiError) {\r\n          console.error('Lỗi khi cập nhật số lượng sản phẩm trên server:', apiError);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Lỗi khi cập nhật giỏ hàng:', error);\r\n      setError('Không thể cập nhật giỏ hàng. Vui lòng thử lại.');\r\n    }\r\n  };\r\n\r\n  // Xóa sản phẩm khỏi giỏ hàng\r\n  const removeFromCart = async (productId) => {\r\n    try {\r\n      // Cập nhật state\r\n      setCart(cart.filter(item => item.id !== productId));\r\n      \r\n      // Nếu đã đăng nhập, đồng bộ với server\r\n      if (isAuthenticated && currentUser) {\r\n        try {\r\n          await cartApi.removeItem(productId);\r\n        } catch (apiError) {\r\n          console.error('Lỗi khi xóa sản phẩm khỏi giỏ hàng trên server:', apiError);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Lỗi khi xóa khỏi giỏ hàng:', error);\r\n      setError('Không thể xóa sản phẩm khỏi giỏ hàng. Vui lòng thử lại.');\r\n    }\r\n  };\r\n\r\n  // Xóa toàn bộ giỏ hàng\r\n  const clearCart = async () => {\r\n    try {\r\n      // Cập nhật state\r\n      setCart([]);\r\n      \r\n      // Nếu đã đăng nhập, đồng bộ với server\r\n      if (isAuthenticated && currentUser) {\r\n        try {\r\n          await cartApi.clearCart();\r\n        } catch (apiError) {\r\n          console.error('Lỗi khi xóa toàn bộ giỏ hàng trên server:', apiError);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Lỗi khi xóa giỏ hàng:', error);\r\n      setError('Không thể xóa giỏ hàng. Vui lòng thử lại.');\r\n    }\r\n  };\r\n\r\n  // Thêm vào danh sách yêu thích\r\n  const addToWishlist = async (product) => {\r\n    try {\r\n      // Kiểm tra sản phẩm đã có trong wishlist chưa\r\n      if (!wishlist.some(item => item.id === product.id)) {\r\n        // Cập nhật state\r\n        setWishlist([...wishlist, product]);\r\n        \r\n        // Nếu đã đăng nhập, đồng bộ với server\r\n        if (isAuthenticated && currentUser) {\r\n          try {\r\n            await cartApi.addToWishlist(product.id);\r\n          } catch (apiError) {\r\n            console.error('Lỗi khi thêm sản phẩm vào wishlist trên server:', apiError);\r\n          }\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Lỗi khi thêm vào danh sách yêu thích:', error);\r\n      setError('Không thể thêm vào danh sách yêu thích. Vui lòng thử lại.');\r\n    }\r\n  };\r\n\r\n  // Xóa khỏi danh sách yêu thích\r\n  const removeFromWishlist = async (productId) => {\r\n    try {\r\n      // Cập nhật state\r\n      setWishlist(wishlist.filter(item => item.id !== productId));\r\n      \r\n      // Nếu đã đăng nhập, đồng bộ với server\r\n      if (isAuthenticated && currentUser) {\r\n        try {\r\n          await cartApi.removeFromWishlist(productId);\r\n        } catch (apiError) {\r\n          console.error('Lỗi khi xóa sản phẩm khỏi wishlist trên server:', apiError);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Lỗi khi xóa khỏi danh sách yêu thích:', error);\r\n      setError('Không thể xóa khỏi danh sách yêu thích. Vui lòng thử lại.');\r\n    }\r\n  };\r\n\r\n  // Tính tổng giá trị giỏ hàng\r\n  const getCartTotal = () => {\r\n    try {\r\n      return cart.reduce((total, item) => {\r\n        const price = item.discount_price || item.price;\r\n        return total + (price * item.quantity);\r\n      }, 0);\r\n    } catch (error) {\r\n      console.error('Lỗi khi tính tổng giỏ hàng:', error);\r\n      return 0;\r\n    }\r\n  };\r\n\r\n  // Lấy sản phẩm theo ID\r\n  const getProductById = async (id) => {\r\n    try {\r\n      setIsLoading(true);\r\n      \r\n      // Gọi API để lấy chi tiết sản phẩm\r\n      const response = await productApi.getById(id);\r\n      return response;\r\n    } catch (err) {\r\n      console.error(`Lỗi khi lấy thông tin sản phẩm ${id}:`, err);\r\n      setError('Không thể tải thông tin sản phẩm. Vui lòng thử lại.');\r\n      return Promise.reject(err);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Lấy sản phẩm theo danh mục\r\n  const getProductsByCategory = async (categoryId) => {\r\n    try {\r\n      setIsLoading(true);\r\n      \r\n      // Gọi API để lấy sản phẩm theo danh mục\r\n      const response = await productApi.getByCategory(categoryId);\r\n      return response;\r\n    } catch (err) {\r\n      console.error(`Lỗi khi lấy sản phẩm theo danh mục:`, err);\r\n      setError('Không thể tải sản phẩm theo danh mục. Vui lòng thử lại.');\r\n      return Promise.reject(err);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Tìm kiếm sản phẩm\r\n  const searchProducts = async (query) => {\r\n    try {\r\n      setIsLoading(true);\r\n      \r\n      // Gọi API để tìm kiếm sản phẩm\r\n      const response = await productApi.search(query);\r\n      return response;\r\n    } catch (err) {\r\n      console.error(`Lỗi khi tìm kiếm sản phẩm:`, err);\r\n      setError('Không thể tìm kiếm sản phẩm. Vui lòng thử lại.');\r\n      return Promise.reject(err);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Các giá trị và hàm được cung cấp qua context\r\n  const value = {\r\n    products,\r\n    categories,\r\n    cart,\r\n    wishlist,\r\n    isLoading,\r\n    error,\r\n    addToCart,\r\n    updateCartItem,\r\n    removeFromCart,\r\n    clearCart,\r\n    addToWishlist,\r\n    removeFromWishlist,\r\n    getCartTotal,\r\n    getProductById,\r\n    getProductsByCategory,\r\n    searchProducts\r\n  };\r\n\r\n  return (\r\n    <ProductContext.Provider value={value}>\r\n      {children}\r\n    </ProductContext.Provider>\r\n  );\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}